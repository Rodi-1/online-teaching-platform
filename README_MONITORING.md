# üìä Monitoring & Logging - Quick Reference

## üéØ –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã

### 1. –ß—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ª–æ–≥–∏, –∞ —á—Ç–æ –∑–∞ –º–µ—Ç—Ä–∏–∫–∏?

**–õ–û–ì–ò üìù** (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è):
- **Promtail** ‚Üí —Å–æ–±–∏—Ä–∞–µ—Ç –∏–∑ Docker
- **Loki** ‚Üí —Ö—Ä–∞–Ω–∏—Ç (http://localhost:3100)
- **Grafana** ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç

**–ú–ï–¢–†–ò–ö–ò üìä** (—á–∏—Å–ª–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏):
- **Prometheus** ‚Üí —Å–æ–±–∏—Ä–∞–µ—Ç –∏ —Ö—Ä–∞–Ω–∏—Ç (http://localhost:9090)
- **postgres-exporter** ‚Üí –º–µ—Ç—Ä–∏–∫–∏ PostgreSQL
- **Grafana** ‚Üí –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç

### 2. –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?

```powershell
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
.\check_monitoring.ps1

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
.\test_traffic.ps1
```

**–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
- Prometheus: http://localhost:9090/targets (–≤—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å UP)
- Loki: http://localhost:3100/ready
- Grafana: http://localhost:3000

### 3. –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Grafana?

**3 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞:**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:3000 (admin/admin)

2. **–î–æ–±–∞–≤—å—Ç–µ Data Sources:**
   - Prometheus: `http://prometheus:9090`
   - Loki: `http://loki:3100`

3. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥—ã:**
   - ID **11133** - FastAPI (–º–µ—Ç—Ä–∏–∫–∏)
   - ID **13639** - Loki (–ª–æ–≥–∏)
   - ID **9628** - PostgreSQL
   - –ò–ª–∏: `grafana-dashboard-metrics.json`

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `check_monitoring.ps1` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç |
| `test_traffic.ps1` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |
| `ANSWERS.md` | –ü–æ–ª–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã |
| `GRAFANA_SETUP_GUIDE.md` | –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ Grafana |
| `MONITORING_CHEATSHEET.md` | –ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞ |
| `MONITORING_ARCHITECTURE.md` | –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ |
| `grafana-dashboard-metrics.json` | –ì–æ—Ç–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥ |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

```powershell
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞
.\check_monitoring.ps1

# 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
.\test_traffic.ps1

# 3. –û—Ç–∫—Ä—ã—Ç—å Grafana
start http://localhost:3000

# –õ–æ–≥–∏–Ω: admin
# –ü–∞—Ä–æ–ª—å: admin
```

---

## üîç –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Grafana:** http://localhost:3000
- **Prometheus:** http://localhost:9090
- **Loki:** http://localhost:3100

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### Prometheus (–º–µ—Ç—Ä–∏–∫–∏):
```promql
# –ó–∞–ø—Ä–æ—Å—ã –≤ —Å–µ–∫—É–Ω–¥—É
sum(rate(http_requests_total[5m])) by (service)

# –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ p95
histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
sum(pg_stat_database_numbackends)
```

### Loki (–ª–æ–≥–∏):
```logql
# –í—Å–µ –ª–æ–≥–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
{container_name=~".*-service"}

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
{container_name=~".*-service"} |= "ERROR"

# –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
{container_name=~".*-service"} | json | duration_ms > 1000
```

---

## ‚úÖ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

**–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- ‚úÖ –í—Å–µ 8 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Prometheus —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ Loki —Å–æ–±–∏—Ä–∞–µ—Ç –ª–æ–≥–∏ –æ—Ç 14 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ Grafana –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Grafana –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥—ã!

–ß–∏—Ç–∞–π—Ç–µ: `ANSWERS.md` –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

