# Tests Service

Микросервис "Тест" для платформы онлайн-обучения.

## Описание

Этот микросервис отвечает за:

- Создание и публикацию тестов преподавателями
- Хранение структуры теста и вопросов
- Старт попытки прохождения теста учеником
- Приём и проверку ответов (автопроверка)
- Хранение и выдачу результатов попыток

## Технологический стек

- **Python 3.11**
- **FastAPI** - веб-фреймворк
- **SQLAlchemy 2.0** - ORM для работы с базой данных
- **PostgreSQL** - база данных
- **Pydantic** - валидация данных

## API Endpoints

### Создание и управление тестами

- `POST /api/courses/{course_id}/tests` - Создать новый тест
- `POST /api/tests/{test_id}:publish` - Опубликовать тест

### Прохождение тестов

- `POST /api/tests/{test_id}/attempts:start` - Начать попытку прохождения
- `POST /api/tests/{test_id}/attempts/{attempt_id}/submit` - Отправить ответы
- `GET /api/tests/{test_id}/attempts/{attempt_id}` - Получить результат попытки
- `GET /api/tests/{test_id}/attempts` - Список попыток по тесту

## Модели данных

### Test
- 4 статуса: draft, published, archived
- Поддержка ограничения по времени
- Даты доступности

### TestQuestion
- 4 типа вопросов: single_choice, multiple_choice, text, number
- Автопроверка ответов
- Настраиваемые баллы

### TestAttempt
- Отслеживание времени начала/окончания
- Автоматический расчёт баллов, процентов, оценок

### TestAnswer
- Хранение ответов студентов
- Результаты проверки

## Автопроверка

Сервис автоматически проверяет ответы:
- **single_choice**: точное совпадение с правильным ответом
- **multiple_choice**: совпадение всех выбранных вариантов
- **text**: сравнение строк (регистронезависимое)
- **number**: сравнение чисел

## Расчёт оценок

- 90-100%: оценка 5
- 75-89%: оценка 4
- 60-74%: оценка 3
- 50-59%: оценка 2
- 0-49%: оценка 2

## Локальный запуск

```bash
docker-compose up tests-service
```

## Переменные окружения

```env
DB_HOST=postgres
DB_PORT=5432
DB_USER=tests_service
DB_PASSWORD=tests_service_pass123
DB_NAME=tests_service_db
JWT_SECRET=your-secret-key
ENV=local
LOG_LEVEL=INFO
```

## Порт

Сервис работает на порту **8006**

## Авторизация

Все эндпоинты требуют JWT токен в заголовке:
```
Authorization: Bearer <token>
```

